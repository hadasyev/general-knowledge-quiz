<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>חידון ידע כללי</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#121a33;
      --muted:#9aa4c7;
      --text:#eef1ff;
      --border:rgba(255,255,255,0.08);
      --shadow: 0 18px 45px rgba(0,0,0,0.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans Hebrew", sans-serif;
      background: radial-gradient(1200px 600px at 80% -10%, rgba(120,140,255,0.25), transparent 60%),
                  radial-gradient(900px 500px at 10% 10%, rgba(0,220,255,0.18), transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .wrap{
      width:min(920px, 100%);
      display:grid;
      gap:18px;
    }
    header{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      padding:8px 6px;
    }
    h1{
      margin:0;
      font-size: clamp(20px, 3vw, 28px);
      letter-spacing: 0.2px;
    }
    .stats{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      color:var(--muted);
      font-size:14px;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      padding:8px 10px;
      border-radius: 999px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.22);
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card-inner{ padding: 22px; }
    .q-title{
      margin:0 0 14px 0;
      font-size: clamp(18px, 2.5vw, 22px);
      line-height:1.35;
    }
    .q-meta{
      margin:0 0 16px 0;
      color:var(--muted);
      font-size:13px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .answers{
      display:grid;
      gap:12px;
      margin-top:12px;
    }
    button.answer{
      width:100%;
      text-align:right;
      padding:14px 14px;
      border-radius:14px;
      border:1px solid var(--border);
      background: rgba(0,0,0,0.18);
      color:var(--text);
      cursor:pointer;
      font-size:16px;
      line-height:1.35;
      transition: transform .06s ease, background .15s ease, border-color .15s ease;
    }
    button.answer:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
    button.answer:disabled{ cursor:not-allowed; opacity:0.85; transform:none; }

    .feedback{
      margin-top:14px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color:var(--muted);
      display:none;
    }
    .feedback.good{ color: #b9f6d0; }
    .feedback.bad{ color: #ffb6b6; }

    .checkpoint{
      display:none;
      margin-top:14px;
      border:1px solid var(--border);
      border-radius:16px;
      background: rgba(255,255,255,0.04);
      padding:14px;
    }
    .checkpoint-box{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .checkpoint-title{
      font-size:18px;
      font-weight:700;
      color:var(--text);
    }
    .checkpoint-text{
      color:var(--muted);
      font-size:14px;
      line-height:1.5;
    }

    .actions{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
      padding: 14px 18px;
      border-top:1px solid var(--border);
      background: rgba(0,0,0,0.15);
      flex-wrap:wrap;
    }
    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,0.06);
      color:var(--text);
      padding:10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-size:14px;
    }
    .btn:hover{ background: rgba(255,255,255,0.10); }
    .btn.secondary{ background: rgba(0,0,0,0.12); }
    .btn.secondary:hover{ background: rgba(255,255,255,0.06); }

    .small{
      color:var(--muted);
      font-size:13px;
    }
    footer{
      color:var(--muted);
      font-size:13px;
      padding: 0 6px;
    }

    .reset-group{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    @media (max-width: 560px){
      .actions{
        flex-direction: column;
        align-items: stretch;
        gap: 14px;
      }
      #nextBtn{ width: 100%; }
      .reset-group{ justify-content: stretch; }
      .reset-group .btn{ width: 100%; }
    }
   .modal{
  display:none;
  position:fixed;
  inset:0;
  z-index:9999;
}

.modal.show{
  display:flex;
  align-items:center;
  justify-content:center;
}

.modal-backdrop{
  position:absolute;
  inset:0;
  background: rgba(5, 8, 18, 0.72);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

.modal-card{
  position:relative;
  width:min(460px, calc(100% - 32px));
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)), var(--card);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:20px;
  box-shadow: 0 24px 60px rgba(0,0,0,0.55);
  padding: 18px 18px 14px 18px;
  text-align: center;
}

.modal-title{
  font-size:18px;
  font-weight:750;
  letter-spacing:0.2px;
  color: var(--text);
  margin-bottom:14px;
  line-height:1.35;
}

.modal-actions{
  display:flex;
  gap:10px;
  justify-content:center;
}

.modal-actions .btn{
  padding:10px 14px;
  border-radius:14px;
}

.modal-actions #modalYesBtn{
  background: rgba(255,255,255,0.12);
  border: 1px solid rgba(255,255,255,0.18);
}

.modal-actions #modalYesBtn:hover{
  background: rgba(255,255,255,0.18);
}

.modal-actions #modalNoBtn{
  background: rgba(0,0,0,0.18);
  border: 1px solid rgba(255,255,255,0.10);
}

.modal-actions #modalNoBtn:hover{
  background: rgba(255,255,255,0.06);
}

@media (max-width:560px){
  .modal-actions{
    flex-direction: column;
    gap:12px;
  }

  .modal-actions .btn{
    width:100%;
  }
}

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>חידון ידע כללי</h1>
      </div>
      <div class="stats">
        <div class="pill">הסבב הנוכחי: <span id="batchScore">0</span>/20</div>
        <div class="pill">ניקוד כולל: <span id="score">0</span></div>
        <div class="pill">נשאלו: <span id="asked">0</span></div>
        <div class="pill">נותרו: <span id="remaining">0</span></div>
      </div>
    </header>

    <div class="card">
      <div class="card-inner">
        <p class="q-meta">
          <span>קטגוריה: <strong id="category">—</strong></span>
        </p>

        <h2 class="q-title" id="question">טוען שאלה…</h2>

        <div class="answers" id="answers"></div>

        <div class="feedback" id="feedback"></div>

        <div class="checkpoint" id="checkpoint">
          <div class="checkpoint-box">
            <div class="checkpoint-title" id="checkpointTitle">עצירה קטנה</div>
            <div class="checkpoint-text" id="checkpointText"></div>
            <button class="btn" id="continueBtn" type="button">ממשיכים!</button>
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn" id="nextBtn" disabled>שאלה הבאה</button>

        <div class="reset-group">
          <button class="btn secondary" id="resetSessionBtn">איפוס ניקוד</button>
          <button class="btn secondary" id="clearHistoryBtn">התחלה מחדש (מחיקת “נשאלו”)</button>
        </div>
      </div>
    </div>

    <footer>
      טיפ: כדי להוסיף שאלות בעתיד, מוסיפים אובייקטים חדשים בתוך <code>QUESTION_BANK</code>.
    </footer>
  </div>
<!-- Confirmation Modal -->
<div class="modal" id="confirmModal" aria-hidden="true">
  <div class="modal-backdrop" id="modalBackdrop"></div>

  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-title" id="modalTitle">כותרת</div>
    <div class="modal-actions">
      <button class="btn" id="modalYesBtn" type="button">כן</button>
      <button class="btn secondary" id="modalNoBtn" type="button">לא</button>
    </div>
  </div>
</div>

<script>
  // correctIndex הוא 0-3 בהתאם למיקום התשובה ב-choices
  const QUESTION_BANK = [
    {"id":"gk-001","category":"היסטוריה","question":"באיזו שנה נפלה חומת ברלין?","choices":["1987","1989","1991","1993"],"correctIndex":1},
    {"id":"gk-002","category":"מדע","question":"מהו היסוד הכימי שמספרו האטומי 26?","choices":["נחושת","אבץ","ברזל","ניקל"],"correctIndex":2},
    {"id":"gk-003","category":"גאוגרפיה","question":"מהי עיר הבירה של קנדה?","choices":["טורונטו","ונקובר","אוטווה","מונטריאול"],"correctIndex":2},
    {"id":"gk-004","category":"תרבות","question":"מי כתב את המחזה \"המלט\"?","choices":["ויליאם שייקספיר","אנטון צ'כוב","מולייר","הנריק איבסן"],"correctIndex":0},
    {"id":"gk-005","category":"כלכלה","question":"מהו המונח המתאר עלייה כללית ומתמשכת ברמת המחירים במשק?","choices":["דפלציה","אינפלציה","מיתון","צמיחה"],"correctIndex":1},

    {"id":"gk-006","category":"מדע","question":"כמה כוכבי לכת יש במערכת השמש?","choices":["7","8","9","10"],"correctIndex":1},
    {"id":"gk-007","category":"גאוגרפיה","question":"איזו יבשת היא הגדולה ביותר לפי שטח?","choices":["אפריקה","אסיה","אירופה","אמריקה הדרומית"],"correctIndex":1},
    {"id":"gk-008","category":"מדע","question":"איזה איבר אחראי בעיקר על סינון רעלים מהדם?","choices":["לב","כבד","ריאות","קיבה"],"correctIndex":1},
    {"id":"gk-009","category":"היסטוריה","question":"מי היה הנשיא הראשון של ארצות הברית?","choices":["תומס ג'פרסון","ג'ורג' וושינגטון","אברהם לינקולן","ג'ון אדמס"],"correctIndex":1},
    {"id":"gk-010","category":"מתמטיקה","question":"מהו הערך של 7×8?","choices":["54","56","64","58"],"correctIndex":1},

    {"id":"gk-011","category":"מדע","question":"מהי הפלנטה הקרובה ביותר לשמש?","choices":["נוגה","כדור הארץ","כוכב חמה","מאדים"],"correctIndex":2},
    {"id":"gk-012","category":"גאוגרפיה","question":"מהו האוקיינוס הגדול ביותר?","choices":["האוקיינוס האטלנטי","האוקיינוס השקט","האוקיינוס ההודי","האוקיינוס הארקטי"],"correctIndex":1},
    {"id":"gk-013","category":"תרבות","question":"איזה צבע מתקבל מערבוב כחול וצהוב?","choices":["סגול","ירוק","כתום","חום"],"correctIndex":1},
    {"id":"gk-014","category":"היסטוריה","question":"באיזו שנה החלה מלחמת העולם הראשונה?","choices":["1914","1917","1939","1905"],"correctIndex":0},
    {"id":"gk-015","category":"מדע","question":"מהי יחידת המידה של עוצמת זרם חשמלי?","choices":["וולט","אמפר","אוהם","וואט"],"correctIndex":1},

    {"id":"gk-016","category":"טבע","question":"איזו חיה היא היונק הגדול ביותר בעולם?","choices":["פיל אפריקאי","לווייתן כחול","היפופוטם","דב קוטב"],"correctIndex":1},
    {"id":"gk-017","category":"גאוגרפיה","question":"איזו מדינה היא הגדולה בעולם לפי שטח?","choices":["קנדה","ארצות הברית","רוסיה","סין"],"correctIndex":2},
    {"id":"gk-018","category":"מדע","question":"מהו ה-pH של מים טהורים בטמפרטורת חדר?","choices":["5","7","9","11"],"correctIndex":1},
    {"id":"gk-019","category":"ספרות","question":"מי כתב את \"הזקן והים\"?","choices":["ארנסט המינגווי","פיצג'רלד","אורוול","קפקא"],"correctIndex":0},
    {"id":"gk-020","category":"כלכלה","question":"מהו המונח המתאר ירידה כללית ברמת המחירים במשק?","choices":["אינפלציה","דפלציה","סטגנציה","ליברליזציה"],"correctIndex":1},

    {"id":"gk-021","category":"גאוגרפיה","question":"איזו מדינה היא ביתם של הפירמידות בגיזה?","choices":["ירדן","מצרים","תוניסיה","סודן"],"correctIndex":1},
    {"id":"gk-022","category":"מדע","question":"מהו הגז הנפוץ ביותר באטמוספרה של כדור הארץ?","choices":["חמצן","פחמן דו-חמצני","חנקן","ארגון"],"correctIndex":2},
    {"id":"gk-023","category":"ספרות","question":"מי כתבה את הספר \"גאווה ודעה קדומה\"?","choices":["אמילי ברונטה","ג'יין אוסטן","מרי שלי","וירג'יניה וולף"],"correctIndex":1},
    {"id":"gk-024","category":"היסטוריה","question":"באיזו שנה הסתיימה מלחמת העולם השנייה באירופה?","choices":["1943","1945","1947","1950"],"correctIndex":1},
    {"id":"gk-025","category":"ספורט","question":"כמה שחקנים יש על המגרש בכל קבוצה בכדורגל?","choices":["9","10","11","12"],"correctIndex":2},

    {"id":"gk-026","category":"מדע","question":"מהו שם התהליך שבו צמחים מייצרים סוכר באמצעות אור השמש?","choices":["נשימה תאית","תסיסה","פוטוסינתזה","אוסמוזה"],"correctIndex":2},
    {"id":"gk-027","category":"גאוגרפיה","question":"איזה הר הוא הגבוה בעולם מעל פני הים?","choices":["אוורסט","קילימנג'רו","מקינלי (דנאלי)","אלברוס"],"correctIndex":0},
    {"id":"gk-028","category":"תרבות","question":"איזה כלי נגינה הוא בעל קלידים ומיתרים ומפיק צליל בעזרת פטישים?","choices":["כינור","פסנתר","חליל","צ'לו"],"correctIndex":1},
    {"id":"gk-029","category":"מדע","question":"מהו הכוכב הקרוב ביותר לכדור הארץ?","choices":["פרוקסימה קנטאורי","השמש","סיריוס","בטלג'וז"],"correctIndex":1},
    {"id":"gk-030","category":"מתמטיקה","question":"מהו המספר הראשוני הקטן ביותר?","choices":["0","1","2","3"],"correctIndex":2},

    {"id":"gk-031","category":"היסטוריה","question":"איזו אימפריה בנתה את הקולוסיאום?","choices":["האימפריה היוונית","האימפריה הרומית","האימפריה הפרסית","האימפריה העות'מאנית"],"correctIndex":1},
    {"id":"gk-032","category":"מדע","question":"איזו מתכת היא נוזלית בטמפרטורת חדר?","choices":["אלומיניום","ברזל","כספית","נחושת"],"correctIndex":2},
    {"id":"gk-033","category":"גאוגרפיה","question":"איזו מדינה מכונה \"ארץ השמש העולה\"?","choices":["קוריאה הדרומית","יפן","סין","וייטנאם"],"correctIndex":1},
    {"id":"gk-034","category":"תרבות","question":"איזו שפה היא המדוברת ביותר בעולם מבחינת מספר דוברים ילידים?","choices":["אנגלית","ספרדית","מנדרינית","ערבית"],"correctIndex":2},
    {"id":"gk-035","category":"מדע","question":"מהו שם הגלקסיה שבה נמצא כדור הארץ?","choices":["אנדרומדה","שביל החלב","משולש","ענן מגלן הגדול"],"correctIndex":1},

    {"id":"gk-036","category":"ספורט","question":"כמה נקודות שווה סל מחוץ לקשת ב-NBA?","choices":["1","2","3","4"],"correctIndex":2},
    {"id":"gk-037","category":"היסטוריה","question":"איזה מסמך אמריקאי נחתם ב-1776?","choices":["החוקה","מגילת העצמאות","מגילת הזכויות","הצהרת פריז"],"correctIndex":1},
    {"id":"gk-038","category":"מדע","question":"מהו שם החלק בתא שמכיל את החומר הגנטי?","choices":["מיטוכונדריה","ריבוזום","גרעין התא","ליזוזום"],"correctIndex":2},
    {"id":"gk-039","category":"גאוגרפיה","question":"איזו מדינה היא הגדולה ביותר בדרום אמריקה לפי שטח?","choices":["ארגנטינה","ברזיל","פרו","צ'ילה"],"correctIndex":1},
    {"id":"gk-040","category":"תרבות","question":"מי צייר את המונה ליזה?","choices":["מיכלאנג'לו","לאונרדו דה וינצ'י","רמברנדט","ואן גוך"],"correctIndex":1},

    {"id":"gk-041","category":"מדע","question":"מהי מהירות האור בקירוב בריק?","choices":["300,000 ק\"מ/שנייה","30,000 ק\"מ/שנייה","3,000 ק\"מ/שנייה","3,000,000 ק\"מ/שנייה"],"correctIndex":0},
    {"id":"gk-042","category":"היסטוריה","question":"איזו עיר נקברה בהתפרצות הר וזוב בשנת 79 לספירה?","choices":["אתונה","רומא","פומפיי","קרתגו"],"correctIndex":2},
    {"id":"gk-043","category":"מתמטיקה","question":"כמה מעלות יש במשולש (סכום הזוויות)?","choices":["90","180","270","360"],"correctIndex":1},
    {"id":"gk-044","category":"גאוגרפיה","question":"באיזו מדינה נמצאת העיר מרקש?","choices":["אלג'יריה","מרוקו","תוניסיה","ספרד"],"correctIndex":1},
    {"id":"gk-045","category":"מדע","question":"איזה ויטמין הגוף מייצר בתגובה לחשיפה לשמש?","choices":["ויטמין A","ויטמין C","ויטמין D","ויטמין B12"],"correctIndex":2},

    {"id":"gk-046","category":"ספרות","question":"מי כתב את \"1984\"?","choices":["ג'ורג' אורוול","אלדוס האקסלי","ריי ברדבורי","ג'ון סטיינבק"],"correctIndex":0},
    {"id":"gk-047","category":"טבע","question":"איזה בעל חיים ידוע כ\"מלך החיות\"?","choices":["פיל","נמר","אריה","זאב"],"correctIndex":2},
    {"id":"gk-048","category":"כלכלה","question":"מהו המונח לתוצר מקומי גולמי?","choices":["GDP","CPI","PPP","IPO"],"correctIndex":0},
    {"id":"gk-049","category":"גאוגרפיה","question":"איזו מדינה גובלת גם באוקיינוס האטלנטי וגם באוקיינוס השקט?","choices":["ברזיל","קולומביה","ארגנטינה","צ'ילה"],"correctIndex":1},
    {"id":"gk-050","category":"מדע","question":"מהו שם הווירוס שגורם לאבעבועות רוח?","choices":["רוטה","וריצלה זוסטר","אינפלואנזה A","רינו"],"correctIndex":1},

    {"id":"gk-051","category":"היסטוריה","question":"איזו מהפכה החלה בצרפת בשנת 1789?","choices":["המהפכה התעשייתית","המהפכה הצרפתית","המהפכה הרוסית","המהפכה האמריקאית"],"correctIndex":1},
    {"id":"gk-052","category":"מדע","question":"איזה כוח מושך עצמים לכיוון מרכז כדור הארץ?","choices":["חיכוך","מגנטיות","כבידה","חשמל סטטי"],"correctIndex":2},
    {"id":"gk-053","category":"תרבות","question":"איזה סגנון מוזיקלי מזוהה עם מוצרט?","choices":["ג'אז","קלאסי","ראפ","רוק"],"correctIndex":1},
    {"id":"gk-054","category":"גאוגרפיה","question":"מהי עיר הבירה של אוסטרליה?","choices":["סידני","מלבורן","קנברה","פרת'"],"correctIndex":2},
    {"id":"gk-055","category":"מדע","question":"כמה כרומוזומים יש בדרך כלל בתא גוף אנושי?","choices":["23","46","64","92"],"correctIndex":1},

    {"id":"gk-056","category":"היסטוריה","question":"איזה עם עתיק בנה את העיר מאצ'ו פיצ'ו?","choices":["האצטקים","האינקה","המאיה","הספרדים"],"correctIndex":1},
    {"id":"gk-057","category":"מתמטיקה","question":"מהו הערך של π בקירוב לשתי ספרות אחרי הנקודה?","choices":["3.12","3.14","3.41","3.24"],"correctIndex":1},
    {"id":"gk-058","category":"מדע","question":"איזו מערכת בגוף אחראית להובלת חמצן וחומרי מזון?","choices":["מערכת העיכול","מערכת הנשימה","מערכת הדם","מערכת העצבים"],"correctIndex":2},
    {"id":"gk-059","category":"גאוגרפיה","question":"איזו מדינה היא הקטנה ביותר בעולם לפי שטח?","choices":["מונקו","סינגפור","קריית הוותיקן","סן מרינו"],"correctIndex":2},
    {"id":"gk-060","category":"תרבות","question":"מי כתב את \"הנסיך הקטן\"?","choices":["ז'ול ורן","אנטואן דה סנט-אכזופרי","אלבר קאמי","ויקטור הוגו"],"correctIndex":1},

    {"id":"gk-061","category":"מדע","question":"מהו שם החלק בעין שאחראי על חדות הראייה הגבוהה ביותר?","choices":["קרנית","רשתית","גומה מרכזית (פוביאה)","עדשה"],"correctIndex":2},
    {"id":"gk-062","category":"היסטוריה","question":"איזו מדינה הייתה הראשונה ששיגרה אדם לחלל?","choices":["ארצות הברית","ברית המועצות","סין","צרפת"],"correctIndex":1},
    {"id":"gk-063","category":"גאוגרפיה","question":"איזו מדינה חוצה קו המשווה וגם את קו התאריך הבינלאומי?","choices":["אקוודור","אינדונזיה","קיריבטי","ברזיל"],"correctIndex":2},
    {"id":"gk-064","category":"כלכלה","question":"איך נקרא מס שמוטל על צריכה ומתווסף למחיר מוצר בישראל?","choices":["מס הכנסה","מע\"מ","ארנונה","מס קנייה"],"correctIndex":1},
    {"id":"gk-065","category":"מדע","question":"מהו שם המולקולה שנושאת מידע תורשתי בתאים?","choices":["ATP","DNA","RNA","גלוקוז"],"correctIndex":1},

    {"id":"gk-066","category":"תרבות","question":"איזו מדינה מזוהה עם מוזיקת פלמנקו?","choices":["איטליה","ספרד","פורטוגל","יוון"],"correctIndex":1},
    {"id":"gk-067","category":"גאוגרפיה","question":"מהו המדבר הגדול ביותר בעולם?","choices":["סהרה","גובי","אטקמה","האנטארקטי (מדבר קוטבי)"],"correctIndex":3},
    {"id":"gk-068","category":"מתמטיקה","question":"מהו חצי מ-90?","choices":["40","45","50","55"],"correctIndex":1},
    {"id":"gk-069","category":"היסטוריה","question":"איזה קיר מפורסם בירושלים נחשב אתר קדוש ביהדות?","choices":["קיר החומה הסינית","הכותל המערבי","חומת אדריאנוס","חומת ברלין"],"correctIndex":1},
    {"id":"gk-070","category":"מדע","question":"איזו פלנטה מכונה \"הכוכב האדום\"?","choices":["נוגה","מאדים","צדק","שבתאי"],"correctIndex":1},

    {"id":"gk-071","category":"ספרות","question":"מי כתב את \"האודיסאה\"?","choices":["הומרוס","אפלטון","סופוקלס","אריסטו"],"correctIndex":0},
    {"id":"gk-072","category":"מדע","question":"איזה איבר בגוף אחראי בעיקר על שאיבת דם?","choices":["מוח","כבד","לב","כליות"],"correctIndex":2},
    {"id":"gk-073","category":"גאוגרפיה","question":"איזו עיר היא בירת דרום אפריקה מבחינה מנהלית (מושב הממשלה)?","choices":["קייפטאון","פרטוריה","יוהנסבורג","דרבן"],"correctIndex":1},
    {"id":"gk-074","category":"תרבות","question":"איזה חג מצוין בארצות הברית ביום חמישי הרביעי של נובמבר?","choices":["יום העצמאות","חג ההודיה","ליל כל הקדושים","חג המולד"],"correctIndex":1},
    {"id":"gk-075","category":"כלכלה","question":"מהו מונח המתאר מצב שבו מחירים עולים בזמן שהצמיחה נמוכה?","choices":["דפלציה","סטגנציה","סטגפלציה","אינפלציה מיובאת"],"correctIndex":2},

    {"id":"gk-076","category":"מדע","question":"איזו שכבה באטמוספרה מכילה את שכבת האוזון?","choices":["טרופוספרה","סטרטוספרה","מזוספרה","תרמוספרה"],"correctIndex":1},
    {"id":"gk-077","category":"היסטוריה","question":"איזה מכתב מפורסם חתם מרטין לותר קינג בשם \"I Have a Dream\"?","choices":["נאום","חוקה","מניפסט","חיבור מדעי"],"correctIndex":0},
    {"id":"gk-078","category":"גאוגרפיה","question":"מהי עיר הבירה של איטליה?","choices":["מילאנו","רומא","נאפולי","ונציה"],"correctIndex":1},
    {"id":"gk-079","category":"מדע","question":"איזה סוג דם נחשב \"תורם אוניברסלי\" בתרומת כדוריות אדומות?","choices":["AB+","O-","O+","AB-"],"correctIndex":1},
    {"id":"gk-080","category":"תרבות","question":"איזו מדינה מזוהה עם מאכל הסושי?","choices":["סין","יפן","תאילנד","קוריאה"],"correctIndex":1},

    {"id":"gk-081","category":"מתמטיקה","question":"כמה צלעות יש למחומש?","choices":["4","5","6","7"],"correctIndex":1},
    {"id":"gk-082","category":"מדע","question":"איזה גז בני אדם נושמים פנימה לצורך תהליך הנשימה?","choices":["חנקן","חמצן","הליום","מימן"],"correctIndex":1},
    {"id":"gk-083","category":"היסטוריה","question":"איזה מלך אנגלי חתם על המגנה כרטה בשנת 1215?","choices":["הנרי השמיני","ריצ'רד הראשון","ג'ון","אדוארד הראשון"],"correctIndex":2},
    {"id":"gk-084","category":"גאוגרפיה","question":"איזו מדינה כוללת את האי סיציליה?","choices":["יוון","איטליה","ספרד","צרפת"],"correctIndex":1},
    {"id":"gk-085","category":"מדע","question":"מהו שם האנרגיה האצורה במזון שמשתחררת בגוף?","choices":["אנרגיה גרעינית","אנרגיה כימית","אנרגיית קול","אנרגיה מגנטית"],"correctIndex":1},

    {"id":"gk-086","category":"תרבות","question":"איזו עיר נחשבת לבירת האופנה המזוהה עם שבוע האופנה הגדול?","choices":["ברלין","פריז","מדריד","ליסבון"],"correctIndex":1},
    {"id":"gk-087","category":"מדע","question":"איזה מדען ניסח את חוקי התנועה והכבידה הקלאסיים?","choices":["אלברט איינשטיין","אייזק ניוטון","ניקולה טסלה","גלילאו גליליי"],"correctIndex":1},
    {"id":"gk-088","category":"גאוגרפיה","question":"מהו הנהר הארוך ביותר באירופה?","choices":["הריין","הדנובה","הוולגה","הסיין"],"correctIndex":2},
    {"id":"gk-089","category":"ספרות","question":"מי כתב את \"עליסה בארץ הפלאות\"?","choices":["לואיס קרול","ג'יי. קיי. רולינג","רואלד דאל","מרק טוויין"],"correctIndex":0},
    {"id":"gk-090","category":"כלכלה","question":"איך נקראת עליית ערך של מטבע ביחס למטבעות אחרים?","choices":["פיחות","ייסוף","קיבוע","המרה"],"correctIndex":1},

    {"id":"gk-091","category":"מדע","question":"איזה איבר אחראי בעיקר על ויסות רמות הסוכר בדם?","choices":["לבלב","טחול","כיס מרה","תוספתן"],"correctIndex":0},
    {"id":"gk-092","category":"היסטוריה","question":"איזו תרבות עתיקה קשורה לכתב יתדות?","choices":["המצרים","השומרים","היוונים","הרומאים"],"correctIndex":1},
    {"id":"gk-093","category":"גאוגרפיה","question":"איזה ים נמצא בין אירופה לאפריקה?","choices":["הים הבלטי","הים האדום","הים התיכון","הים השחור"],"correctIndex":2},
    {"id":"gk-094","category":"תרבות","question":"איזו יצירה היא של בטהובן?","choices":["ארבע העונות","הפוגה הגדולה","מולדתי","כרמן"],"correctIndex":1},
    {"id":"gk-095","category":"מדע","question":"איזו יחידת מידה משמשת למדידת טמפרטורה במערכת SI?","choices":["פרנהייט","קלווין","צלזיוס","מעלות"],"correctIndex":1},

    {"id":"gk-096","category":"מתמטיקה","question":"מהו הערך של 12+15?","choices":["25","26","27","28"],"correctIndex":2},
    {"id":"gk-097","category":"היסטוריה","question":"מה היה שם הספינה שבה הפליג צ'ארלס דרווין במסעו המפורסם?","choices":["ויקטורי","ביגל","אנדוור","סנטה מריה"],"correctIndex":1},
    {"id":"gk-098","category":"גאוגרפיה","question":"איזו מדינה ידועה כ\"ארץ אלף האגמים\"?","choices":["נורווגיה","שוודיה","פינלנד","איסלנד"],"correctIndex":2},
    {"id":"gk-099","category":"מדע","question":"מהו שם התופעה שבה גוף מאבד חום לסביבה?","choices":["הולכה","קרינה","התקררות","עיבוי"],"correctIndex":2},
    {"id":"gk-100","category":"תרבות","question":"איזו מדינה מזוהה עם פסטיבל קרנבל בריו?","choices":["ספרד","ברזיל","פורטוגל","איטליה"],"correctIndex":1}
  ];

  const STORAGE_KEY = "gk_quiz_asked_ids_v1";
  const CHECKPOINT_EVERY = 20;

  let score = 0;
  let currentQ = null;
  let locked = false;

  let batchCorrect = 0;
  let batchAnswered = 0;

  function loadAskedIds() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return new Set();
      const arr = JSON.parse(raw);
      return new Set(Array.isArray(arr) ? arr : []);
    } catch {
      return new Set();
    }
  }

  function saveAskedIds(set) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify([...set]));
  }

  function getAvailableQuestions() {
    const asked = loadAskedIds();
    return QUESTION_BANK.filter(q => !asked.has(q.id));
  }

  function updateStats() {
    const asked = loadAskedIds();
    document.getElementById("score").textContent = String(score);
    document.getElementById("asked").textContent = String(asked.size);
    document.getElementById("remaining").textContent = String(getAvailableQuestions().length);
    document.getElementById("batchScore").textContent = String(batchCorrect);
  }

  function pickNextQuestion() {
    const available = getAvailableQuestions();
    if (available.length === 0) return null;
    return available[Math.floor(Math.random() * available.length)];
  }

  function hideCheckpoint(){
    document.getElementById("checkpoint").style.display = "none";
  }

function showCheckpoint(){
  const titleEl = document.getElementById("checkpointTitle");
  const textEl = document.getElementById("checkpointText");
  const cp = document.getElementById("checkpoint");

  titleEl.textContent = "עצירה קטנה";

  let suffix = "";
  if (batchCorrect === 20) {
    suffix = " מושלם!";
  } else if (batchCorrect >= 16) {
    suffix = " מעולה!";
  } else if (batchCorrect >= 11) {
    suffix = " יפה!";
  } else {
    suffix = "";
  }

  textEl.textContent =
    "ענית נכון על " + batchCorrect + " מתוך " + CHECKPOINT_EVERY +
    " שאלות בסיבוב הזה." + suffix + " שנמשיך לסיבוב הבא?";

  cp.style.display = "block";
}

  function renderQuestion(q) {
    currentQ = q;
    locked = false;

    document.getElementById("category").textContent = q.category || "כללי";
    document.getElementById("question").textContent = q.question;

    const answersEl = document.getElementById("answers");
    answersEl.innerHTML = "";

    q.choices.forEach((text, idx) => {
      const btn = document.createElement("button");
      btn.className = "answer";
      btn.type = "button";
      btn.textContent = text;
      btn.addEventListener("click", () => onAnswer(idx, btn));
      answersEl.appendChild(btn);
    });

    const feedback = document.getElementById("feedback");
    feedback.style.display = "none";
    feedback.className = "feedback";
    feedback.textContent = "";

    hideCheckpoint();

    document.getElementById("nextBtn").disabled = true;
    updateStats();
  }

  function onAnswer(chosenIndex, chosenBtn) {
    if (locked || !currentQ) return;
    locked = true;

    const correct = currentQ.correctIndex === chosenIndex;

    const feedback = document.getElementById("feedback");
    feedback.style.display = "block";
    feedback.className = "feedback " + (correct ? "good" : "bad");

    const allButtons = [...document.querySelectorAll("button.answer")];
    allButtons.forEach((b, idx) => {
      b.disabled = true;
      if (idx === currentQ.correctIndex) {
        b.style.borderColor = "rgba(185,246,208,0.55)";
        b.style.background = "rgba(185,246,208,0.10)";
      }
    });

    if (correct) {
      score += 1;
      feedback.textContent = "נכון!";
    } else {
      chosenBtn.style.borderColor = "rgba(255,182,182,0.55)";
      chosenBtn.style.background = "rgba(255,182,182,0.10)";
      const correctText = currentQ.choices[currentQ.correctIndex];
      feedback.textContent = `לא נכון, אבל לא נורא. התשובה הנכונה: ${correctText}`;
    }

    batchAnswered += 1;
    if (correct) batchCorrect += 1;

    const asked = loadAskedIds();
    asked.add(currentQ.id);
    saveAskedIds(asked);

    document.getElementById("nextBtn").disabled = false;
    updateStats();
  }

  function showEndScreen() {
    document.getElementById("category").textContent = "—";
    document.getElementById("question").textContent = "סיימת את כל השאלות במאגר! כל הכבוד!";

    document.getElementById("answers").innerHTML = "";

    const feedback = document.getElementById("feedback");
    feedback.style.display = "block";
    feedback.className = "feedback good";
    feedback.textContent = "רוצה עוד סיבוב? אפשר ללחוץ על "להתחיל מחדש" ולהמשיך";
    document.getElementById("nextBtn").disabled = true;

    hideCheckpoint();
    updateStats();
  }

  function next() {
    // עצירה כל 20 שאלות לפני שממשיכים לשאלה הבאה
    if (batchAnswered > 0 && batchAnswered % CHECKPOINT_EVERY === 0) {
      showCheckpoint();
      return;
    }

    const q = pickNextQuestion();
    if (!q) {
      showEndScreen();
      return;
    }
    renderQuestion(q);
  }

  document.getElementById("nextBtn").addEventListener("click", next);

  document.getElementById("continueBtn").addEventListener("click", () => {
    hideCheckpoint();
    batchCorrect = 0;
    batchAnswered = 0;
    next();
  });
let pendingAction = null;

function openConfirmModal(title, action) {
  pendingAction = action;

  document.getElementById("modalTitle").textContent = title;
  const modal = document.getElementById("confirmModal");
  modal.classList.add("show");
  modal.setAttribute("aria-hidden", "false");
}

function closeConfirmModal() {
  pendingAction = null;

  const modal = document.getElementById("confirmModal");
  modal.classList.remove("show");
  modal.setAttribute("aria-hidden", "true");
}
document.getElementById("modalYesBtn").addEventListener("click", () => {
  if (typeof pendingAction === "function") pendingAction();
  closeConfirmModal();
});

document.getElementById("modalNoBtn").addEventListener("click", closeConfirmModal);
document.getElementById("modalBackdrop").addEventListener("click", closeConfirmModal);

  document.getElementById("resetSessionBtn").addEventListener("click", () => {
  openConfirmModal("לאפס את הניקוד?", () => {
    score = 0;
    batchCorrect = 0;
    batchAnswered = 0;
    hideCheckpoint();
    updateStats();
});
  });

  document.getElementById("clearHistoryBtn").addEventListener("click", () => {
  openConfirmModal("להתחיל מחדש?", () => {
    localStorage.removeItem(STORAGE_KEY);
    score = 0;
    batchCorrect = 0;
    batchAnswered = 0;
    hideCheckpoint();
    next();
});
  });

  updateStats();
  next();
</script>
</body>
</html>










